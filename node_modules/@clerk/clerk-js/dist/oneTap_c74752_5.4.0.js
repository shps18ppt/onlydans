"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[379],{5058:function(e,n,t){t.r(n),t.d(n,{OneTap:function(){return _}});var r=t(2903),i=t(2784),c=t(3918),o=t(3476),l=t(3736),a=t(6131),s=t(9286),u=t(8512),p=t(1661);const d=(0,u.withCardStateProvider)((function(){const e=(0,a.cL)(),{user:n}=(0,a.aF)(),t=(0,c.useEnvironment)(),r=(0,i.useRef)(!1),{navigate:o}=(0,l.useRouter)(),u=(0,c.useGoogleOneTapContext)(),{signInUrl:d,signUpUrl:g,continueSignUpUrl:_,secondFactorUrl:U,firstFactorUrl:f,signUpForceRedirectUrl:h,signInForceRedirectUrl:k}=u;async function T(n){r.current=!1;try{const t=await e.__experimental_authenticateWithGoogleOneTap({token:n.credential});await e.__experimental_handleGoogleOneTapCallback(t,{signInUrl:d,signUpUrl:g,continueSignUpUrl:_,secondFactorUrl:U,firstFactorUrl:f,signUpForceRedirectUrl:h,signInForceRedirectUrl:k},o)}catch(t){console.error(t)}}const w=t.displayConfig.googleOneTapClientId,m=!(null==n?void 0:n.id)&&!!w,{data:F}=(0,p.ib)(m?async function(){const e=await(0,s.g)();return e.accounts.id.initialize({client_id:w,callback:T,itp_support:u.itpSupport,cancel_on_tap_outside:u.cancelOnTapOutside,auto_select:!1,use_fedcm_for_prompt:u.fedCmSupport}),e}:void 0,"google-identity-services-script");return(0,i.useEffect)((()=>{!F||(null==n?void 0:n.id)||r.current||(F.accounts.id.prompt((n=>{"skipped"===n.getMomentType()&&e.__experimental_closeGoogleOneTap()})),r.current=!0)}),[e,F,null==n?void 0:n.id]),(0,i.useEffect)((()=>()=>{F&&r.current&&(r.current=!1,F.accounts.id.cancel())}),[F]),null}));function g(){return(0,r.tZ)(l.Route,{path:"one-tap",children:(0,r.tZ)(o.Flow.Root,{flow:"oneTap",children:(0,r.tZ)(l.Switch,{children:(0,r.tZ)(l.Route,{index:!0,children:(0,r.tZ)(d,{})})})})})}g.displayName="OneTap";const _=(0,c.withCoreSessionSwitchGuard)(g)}}]);